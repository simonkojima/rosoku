
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/example_within-subject-classification-deeplearning.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_example_within-subject-classification-deeplearning.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_example_within-subject-classification-deeplearning.py:


Example: Within-subject classification with deep learning
=========================================================

.. GENERATED FROM PYTHON SOURCE LINES 7-20

.. code-block:: Python

    import random
    import numpy as np
    import matplotlib.pyplot as plt

    from pathlib import Path

    import mne
    import tag_mne as tm

    import torch
    import braindecode
    import rosoku








.. GENERATED FROM PYTHON SOURCE LINES 21-28

.. code-block:: Python


    np.random.seed(42)
    random.seed(42)
    torch.manual_seed(42)
    torch.cuda.manual_seed(42)
    torch.cuda.manual_seed_all(42)








.. GENERATED FROM PYTHON SOURCE LINES 29-47

.. code-block:: Python


    subject = 7

    lr = 1e-3
    weight_decay = 1e-2
    n_epochs = 500
    batch_size = 2
    patience = 75
    enable_euclidean_alignment = False
    enable_normalization = True
    device = "cuda" if torch.cuda.is_available() else "cpu"
    enable_ddp = False
    enable_dp = False

    save_base = Path("~").expanduser() / "rosoku-log"
    (save_base / "checkpoint").mkdir(parents=True, exist_ok=True)
    (save_base / "history").mkdir(parents=True, exist_ok=True)








.. GENERATED FROM PYTHON SOURCE LINES 48-122

.. code-block:: Python



    def func_proc_epochs(epochs, mode, tmin=0, tmax=2):
        epochs = epochs.pick(picks="eeg").crop(tmin=tmin, tmax=tmax)
        return epochs


    def func_load_epochs(keywords, mode, tmin=-1, tmax=2.5, runs=[4, 8, 12]):

        subject = keywords[0]

        fnames = mne.datasets.eegbci.load_data(subject, runs, update_path=True)

        epochs_list = []
        for fname, run in zip(fnames, runs):
            raw = mne.io.read_raw_edf(fname, preload=True)

            events, event_id = mne.events_from_annotations(raw)

            samples, markers = tm.markers_from_events(events, event_id)

            event_names = {"left": "T1", "right": "T2"}
            markers = tm.add_event_names(markers, event_names)

            markers = tm.add_tag(markers, f"run:{run}")
            samples, markers = tm.remove(samples, markers, "marker:T0")

            events, event_id = tm.events_from_markers(samples, markers)

            raw.filter(
                l_freq=12,
                h_freq=15,
                method="iir",
                iir_params={"order": 4, "ftype": "butterworth", "btype": "bandpass"},
                phase="zero",
            )

            epochs_run = mne.Epochs(
                raw, events, event_id, tmin=tmin, tmax=tmax, preload=True
            )

            epochs_run = epochs_run.resample(128)

            epochs_list.append(epochs_run)

        epochs = tm.concatenate_epochs(epochs_list)

        if mode == "train":
            return epochs["run:4"]
        elif mode == "valid":
            return epochs["run:8"]
        elif mode == "test":
            return epochs["run:12"]


    def func_get_model(X, y):
        _, n_chans, n_times = X.shape
        F1 = 4
        D = 2
        F2 = F1 * D

        model = braindecode.models.EEGNetv4(
            n_chans=n_chans,
            n_outputs=2,
            n_times=n_times,
            F1=F1,
            D=D,
            F2=F2,
            drop_prob=0.5,
        )

        return model









.. GENERATED FROM PYTHON SOURCE LINES 123-164

.. code-block:: Python

    label_keys = {"event:left": 0, "event:right": 1}

    criterion = torch.nn.CrossEntropyLoss()
    scheduler = torch.optim.lr_scheduler.CosineAnnealingLR
    scheduler_params = {"T_max": n_epochs, "eta_min": 1e-6}
    optimizer = torch.optim.AdamW
    optimizer_params = {"lr": lr, "weight_decay": weight_decay}
    early_stopping = rosoku.utils.EarlyStopping(patience=patience)

    results = rosoku.deeplearning(
        keywords_train=[subject],
        keywords_valid=[subject],
        keywords_test=[subject],
        func_load_epochs=func_load_epochs,
        apply_func_proc_per_obj=True,
        batch_size=batch_size,
        n_epochs=n_epochs,
        criterion=criterion,
        optimizer=optimizer,
        optimizer_params=optimizer_params,
        func_get_model=func_get_model,
        scheduler=scheduler,
        scheduler_params=scheduler_params,
        device=device,
        enable_ddp=enable_ddp,
        func_proc_epochs=func_proc_epochs,
        label_keys=label_keys,
        early_stopping=early_stopping,
        enable_normalization=enable_normalization,
        name_classifier="eegnet4.2",
        history_fname=(save_base / "history" / f"sub-{subject}"),
        checkpoint_fname=(save_base / "checkpoint" / f"sub-{subject}"),
        desc="eegnet4.2/drop_prob=0.25",
        enable_wandb_logging=False,
        wandb_params={
            "project": "wandb-project-name",
            "name": f"sub-{subject}",
        },
    )

    print(results.loc[0])




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Using default location ~/mne_data for EEGBCI...
    Creating /home/runner/mne_data
    Downloading EEGBCI data
    Downloading file 'S007/S007R04.edf' from 'https://physionet.org/files/eegmmidb/1.0.0/S007/S007R04.edf' to '/home/runner/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0'.
    Downloading file 'S007/S007R08.edf' from 'https://physionet.org/files/eegmmidb/1.0.0/S007/S007R08.edf' to '/home/runner/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0'.
    Downloading file 'S007/S007R12.edf' from 'https://physionet.org/files/eegmmidb/1.0.0/S007/S007R12.edf' to '/home/runner/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0'.
    Attempting to create new mne-python configuration file:
    /home/runner/.mne/mne-python.json
    Could not read the /home/runner/.mne/mne-python.json json file during the writing. Assuming it is empty. Got: Expecting value: line 1 column 1 (char 0)
    Download complete in 15s (7.4 MB)
    Extracting EDF parameters from /home/runner/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S007/S007R04.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Used Annotations descriptions: [np.str_('T0'), np.str_('T1'), np.str_('T2')]
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 12 - 15 Hz

    IIR filter parameters
    ---------------------
    butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 12.00, 15.00 Hz: -6.02, -6.02 dB

    Not setting metadata
    15 matching events found
    Setting baseline interval to [-1.0, 0.0] s
    Applying baseline correction (mode: mean)
    0 projection items activated
    Using data from preloaded Raw for 15 events and 561 original time points ...
    0 bad epochs dropped
    Extracting EDF parameters from /home/runner/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S007/S007R08.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Used Annotations descriptions: [np.str_('T0'), np.str_('T1'), np.str_('T2')]
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 12 - 15 Hz

    IIR filter parameters
    ---------------------
    butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 12.00, 15.00 Hz: -6.02, -6.02 dB

    Not setting metadata
    15 matching events found
    Setting baseline interval to [-1.0, 0.0] s
    Applying baseline correction (mode: mean)
    0 projection items activated
    Using data from preloaded Raw for 15 events and 561 original time points ...
    0 bad epochs dropped
    Extracting EDF parameters from /home/runner/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S007/S007R12.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Used Annotations descriptions: [np.str_('T0'), np.str_('T1'), np.str_('T2')]
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 12 - 15 Hz

    IIR filter parameters
    ---------------------
    butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 12.00, 15.00 Hz: -6.02, -6.02 dB

    Not setting metadata
    15 matching events found
    Setting baseline interval to [-1.0, 0.0] s
    Applying baseline correction (mode: mean)
    0 projection items activated
    Using data from preloaded Raw for 15 events and 561 original time points ...
    0 bad epochs dropped
    /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/tag_mne/mne_utils.py:14: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
      return mne.concatenate_epochs(epochs_list, add_offset)
    Not setting metadata
    45 matching events found
    Applying baseline correction (mode: mean)
    Extracting EDF parameters from /home/runner/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S007/S007R04.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Used Annotations descriptions: [np.str_('T0'), np.str_('T1'), np.str_('T2')]
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 12 - 15 Hz

    IIR filter parameters
    ---------------------
    butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 12.00, 15.00 Hz: -6.02, -6.02 dB

    Not setting metadata
    15 matching events found
    Setting baseline interval to [-1.0, 0.0] s
    Applying baseline correction (mode: mean)
    0 projection items activated
    Using data from preloaded Raw for 15 events and 561 original time points ...
    0 bad epochs dropped
    Extracting EDF parameters from /home/runner/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S007/S007R08.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Used Annotations descriptions: [np.str_('T0'), np.str_('T1'), np.str_('T2')]
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 12 - 15 Hz

    IIR filter parameters
    ---------------------
    butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 12.00, 15.00 Hz: -6.02, -6.02 dB

    Not setting metadata
    15 matching events found
    Setting baseline interval to [-1.0, 0.0] s
    Applying baseline correction (mode: mean)
    0 projection items activated
    Using data from preloaded Raw for 15 events and 561 original time points ...
    0 bad epochs dropped
    Extracting EDF parameters from /home/runner/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S007/S007R12.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Used Annotations descriptions: [np.str_('T0'), np.str_('T1'), np.str_('T2')]
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 12 - 15 Hz

    IIR filter parameters
    ---------------------
    butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 12.00, 15.00 Hz: -6.02, -6.02 dB

    Not setting metadata
    15 matching events found
    Setting baseline interval to [-1.0, 0.0] s
    Applying baseline correction (mode: mean)
    0 projection items activated
    Using data from preloaded Raw for 15 events and 561 original time points ...
    0 bad epochs dropped
    /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/tag_mne/mne_utils.py:14: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
      return mne.concatenate_epochs(epochs_list, add_offset)
    Not setting metadata
    45 matching events found
    Applying baseline correction (mode: mean)
    Extracting EDF parameters from /home/runner/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S007/S007R04.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Used Annotations descriptions: [np.str_('T0'), np.str_('T1'), np.str_('T2')]
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 12 - 15 Hz

    IIR filter parameters
    ---------------------
    butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 12.00, 15.00 Hz: -6.02, -6.02 dB

    Not setting metadata
    15 matching events found
    Setting baseline interval to [-1.0, 0.0] s
    Applying baseline correction (mode: mean)
    0 projection items activated
    Using data from preloaded Raw for 15 events and 561 original time points ...
    0 bad epochs dropped
    Extracting EDF parameters from /home/runner/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S007/S007R08.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Used Annotations descriptions: [np.str_('T0'), np.str_('T1'), np.str_('T2')]
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 12 - 15 Hz

    IIR filter parameters
    ---------------------
    butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 12.00, 15.00 Hz: -6.02, -6.02 dB

    Not setting metadata
    15 matching events found
    Setting baseline interval to [-1.0, 0.0] s
    Applying baseline correction (mode: mean)
    0 projection items activated
    Using data from preloaded Raw for 15 events and 561 original time points ...
    0 bad epochs dropped
    Extracting EDF parameters from /home/runner/mne_data/MNE-eegbci-data/files/eegmmidb/1.0.0/S007/S007R12.edf...
    EDF file detected
    Setting channel info structure...
    Creating raw.info structure...
    Reading 0 ... 19999  =      0.000 ...   124.994 secs...
    Used Annotations descriptions: [np.str_('T0'), np.str_('T1'), np.str_('T2')]
    Filtering raw data in 1 contiguous segment
    Setting up band-pass filter from 12 - 15 Hz

    IIR filter parameters
    ---------------------
    butterworth bandpass zero-phase (two-pass forward and reverse) non-causal filter:
    - Filter order 16 (effective, after forward-backward)
    - Cutoffs at 12.00, 15.00 Hz: -6.02, -6.02 dB

    Not setting metadata
    15 matching events found
    Setting baseline interval to [-1.0, 0.0] s
    Applying baseline correction (mode: mean)
    0 projection items activated
    Using data from preloaded Raw for 15 events and 561 original time points ...
    0 bad epochs dropped
    /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/tag_mne/mne_utils.py:14: RuntimeWarning: Concatenation of Annotations within Epochs is not supported yet. All annotations will be dropped.
      return mne.concatenate_epochs(epochs_list, add_offset)
    Not setting metadata
    45 matching events found
    Applying baseline correction (mode: mean)
    epoch 000, train_loss: 0.6931, train_acc: 0.47, valid_loss: 0.6930, valid_acc: 0.53, lr: 9.9999e-04, et: 0.0823, checkpoint saved
    epoch 001, train_loss: 0.6927, train_acc: 0.53, valid_loss: 0.6927, valid_acc: 0.53, lr: 9.9996e-04, et: 0.0744, checkpoint saved
    epoch 002, train_loss: 0.6920, train_acc: 0.53, valid_loss: 0.6928, valid_acc: 0.53, lr: 9.9991e-04, et: 0.0734
    epoch 003, train_loss: 0.6913, train_acc: 0.53, valid_loss: 0.6933, valid_acc: 0.53, lr: 9.9984e-04, et: 0.0737
    epoch 004, train_loss: 0.6905, train_acc: 0.53, valid_loss: 0.6936, valid_acc: 0.53, lr: 9.9975e-04, et: 0.0738
    epoch 005, train_loss: 0.6892, train_acc: 0.53, valid_loss: 0.6933, valid_acc: 0.53, lr: 9.9965e-04, et: 0.0724
    epoch 006, train_loss: 0.6876, train_acc: 0.53, valid_loss: 0.6929, valid_acc: 0.53, lr: 9.9952e-04, et: 0.0731
    epoch 007, train_loss: 0.6860, train_acc: 0.53, valid_loss: 0.6924, valid_acc: 0.53, lr: 9.9937e-04, et: 0.0729, checkpoint saved
    epoch 008, train_loss: 0.6843, train_acc: 0.53, valid_loss: 0.6918, valid_acc: 0.53, lr: 9.9920e-04, et: 0.0730, checkpoint saved
    epoch 009, train_loss: 0.6823, train_acc: 0.53, valid_loss: 0.6917, valid_acc: 0.53, lr: 9.9901e-04, et: 0.0747, checkpoint saved
    epoch 010, train_loss: 0.6802, train_acc: 0.53, valid_loss: 0.6913, valid_acc: 0.53, lr: 9.9881e-04, et: 0.0735, checkpoint saved
    epoch 011, train_loss: 0.6774, train_acc: 0.53, valid_loss: 0.6912, valid_acc: 0.53, lr: 9.9858e-04, et: 0.0718, checkpoint saved
    epoch 012, train_loss: 0.6743, train_acc: 0.60, valid_loss: 0.6924, valid_acc: 0.53, lr: 9.9833e-04, et: 0.0711
    epoch 013, train_loss: 0.6696, train_acc: 0.73, valid_loss: 0.6929, valid_acc: 0.47, lr: 9.9807e-04, et: 0.0704
    epoch 014, train_loss: 0.6632, train_acc: 0.80, valid_loss: 0.6920, valid_acc: 0.47, lr: 9.9778e-04, et: 0.0708
    epoch 015, train_loss: 0.6562, train_acc: 0.87, valid_loss: 0.6906, valid_acc: 0.40, lr: 9.9748e-04, et: 0.0714, checkpoint saved
    epoch 016, train_loss: 0.6481, train_acc: 0.87, valid_loss: 0.6875, valid_acc: 0.47, lr: 9.9715e-04, et: 0.0727, checkpoint saved
    epoch 017, train_loss: 0.6397, train_acc: 0.87, valid_loss: 0.6834, valid_acc: 0.47, lr: 9.9681e-04, et: 0.0701, checkpoint saved
    epoch 018, train_loss: 0.6325, train_acc: 0.87, valid_loss: 0.6828, valid_acc: 0.47, lr: 9.9644e-04, et: 0.0698, checkpoint saved
    epoch 019, train_loss: 0.6257, train_acc: 0.87, valid_loss: 0.6808, valid_acc: 0.47, lr: 9.9606e-04, et: 0.0701, checkpoint saved
    epoch 020, train_loss: 0.6163, train_acc: 0.87, valid_loss: 0.6778, valid_acc: 0.47, lr: 9.9566e-04, et: 0.0709, checkpoint saved
    epoch 021, train_loss: 0.6028, train_acc: 0.93, valid_loss: 0.6757, valid_acc: 0.53, lr: 9.9524e-04, et: 0.0709, checkpoint saved
    epoch 022, train_loss: 0.5852, train_acc: 1.00, valid_loss: 0.6739, valid_acc: 0.53, lr: 9.9479e-04, et: 0.0702, checkpoint saved
    epoch 023, train_loss: 0.5711, train_acc: 1.00, valid_loss: 0.6682, valid_acc: 0.47, lr: 9.9433e-04, et: 0.0710, checkpoint saved
    epoch 024, train_loss: 0.5571, train_acc: 1.00, valid_loss: 0.6631, valid_acc: 0.53, lr: 9.9385e-04, et: 0.0704, checkpoint saved
    epoch 025, train_loss: 0.5352, train_acc: 1.00, valid_loss: 0.6599, valid_acc: 0.47, lr: 9.9335e-04, et: 0.0702, checkpoint saved
    epoch 026, train_loss: 0.5161, train_acc: 1.00, valid_loss: 0.6614, valid_acc: 0.60, lr: 9.9283e-04, et: 0.0707
    epoch 027, train_loss: 0.4902, train_acc: 1.00, valid_loss: 0.6614, valid_acc: 0.53, lr: 9.9229e-04, et: 0.0700
    epoch 028, train_loss: 0.4675, train_acc: 1.00, valid_loss: 0.6528, valid_acc: 0.60, lr: 9.9173e-04, et: 0.0715, checkpoint saved
    epoch 029, train_loss: 0.4614, train_acc: 1.00, valid_loss: 0.6491, valid_acc: 0.60, lr: 9.9115e-04, et: 0.0711, checkpoint saved
    epoch 030, train_loss: 0.4477, train_acc: 1.00, valid_loss: 0.6466, valid_acc: 0.60, lr: 9.9055e-04, et: 0.0714, checkpoint saved
    epoch 031, train_loss: 0.4016, train_acc: 1.00, valid_loss: 0.6393, valid_acc: 0.60, lr: 9.8994e-04, et: 0.0706, checkpoint saved
    epoch 032, train_loss: 0.3744, train_acc: 1.00, valid_loss: 0.6314, valid_acc: 0.60, lr: 9.8930e-04, et: 0.0704, checkpoint saved
    epoch 033, train_loss: 0.3595, train_acc: 1.00, valid_loss: 0.6315, valid_acc: 0.60, lr: 9.8865e-04, et: 0.0711
    epoch 034, train_loss: 0.3349, train_acc: 1.00, valid_loss: 0.6201, valid_acc: 0.60, lr: 9.8797e-04, et: 0.0709, checkpoint saved
    epoch 035, train_loss: 0.3120, train_acc: 1.00, valid_loss: 0.6024, valid_acc: 0.67, lr: 9.8728e-04, et: 0.0713, checkpoint saved
    epoch 036, train_loss: 0.2852, train_acc: 1.00, valid_loss: 0.5851, valid_acc: 0.67, lr: 9.8656e-04, et: 0.0726, checkpoint saved
    epoch 037, train_loss: 0.2725, train_acc: 1.00, valid_loss: 0.5824, valid_acc: 0.67, lr: 9.8583e-04, et: 0.0722, checkpoint saved
    epoch 038, train_loss: 0.2686, train_acc: 1.00, valid_loss: 0.5540, valid_acc: 0.73, lr: 9.8508e-04, et: 0.0710, checkpoint saved
    epoch 039, train_loss: 0.2285, train_acc: 1.00, valid_loss: 0.5685, valid_acc: 0.73, lr: 9.8431e-04, et: 0.0707
    epoch 040, train_loss: 0.1885, train_acc: 1.00, valid_loss: 0.5968, valid_acc: 0.67, lr: 9.8352e-04, et: 0.0713
    epoch 041, train_loss: 0.1593, train_acc: 1.00, valid_loss: 0.6267, valid_acc: 0.67, lr: 9.8271e-04, et: 0.0715
    epoch 042, train_loss: 0.1466, train_acc: 1.00, valid_loss: 0.6701, valid_acc: 0.67, lr: 9.8188e-04, et: 0.0706
    epoch 043, train_loss: 0.1394, train_acc: 1.00, valid_loss: 0.6482, valid_acc: 0.67, lr: 9.8103e-04, et: 0.0727
    epoch 044, train_loss: 0.1418, train_acc: 1.00, valid_loss: 0.6048, valid_acc: 0.67, lr: 9.8017e-04, et: 0.0722
    epoch 045, train_loss: 0.1365, train_acc: 1.00, valid_loss: 0.5648, valid_acc: 0.67, lr: 9.7928e-04, et: 0.0725
    epoch 046, train_loss: 0.1254, train_acc: 1.00, valid_loss: 0.5444, valid_acc: 0.73, lr: 9.7838e-04, et: 0.0718, checkpoint saved
    epoch 047, train_loss: 0.1137, train_acc: 1.00, valid_loss: 0.5585, valid_acc: 0.67, lr: 9.7745e-04, et: 0.0710
    epoch 048, train_loss: 0.1108, train_acc: 1.00, valid_loss: 0.5759, valid_acc: 0.73, lr: 9.7651e-04, et: 0.0717
    epoch 049, train_loss: 0.0813, train_acc: 1.00, valid_loss: 0.5910, valid_acc: 0.80, lr: 9.7555e-04, et: 0.0737
    epoch 050, train_loss: 0.0720, train_acc: 1.00, valid_loss: 0.6125, valid_acc: 0.80, lr: 9.7457e-04, et: 0.0720
    epoch 051, train_loss: 0.0602, train_acc: 1.00, valid_loss: 0.6112, valid_acc: 0.80, lr: 9.7358e-04, et: 0.0722
    epoch 052, train_loss: 0.0518, train_acc: 1.00, valid_loss: 0.6125, valid_acc: 0.80, lr: 9.7256e-04, et: 0.0715
    epoch 053, train_loss: 0.0496, train_acc: 1.00, valid_loss: 0.6279, valid_acc: 0.73, lr: 9.7152e-04, et: 0.0721
    epoch 054, train_loss: 0.0489, train_acc: 1.00, valid_loss: 0.6633, valid_acc: 0.67, lr: 9.7047e-04, et: 0.0722
    epoch 055, train_loss: 0.0529, train_acc: 1.00, valid_loss: 0.7110, valid_acc: 0.67, lr: 9.6940e-04, et: 0.0720
    epoch 056, train_loss: 0.0525, train_acc: 1.00, valid_loss: 0.7065, valid_acc: 0.67, lr: 9.6831e-04, et: 0.0712
    epoch 057, train_loss: 0.0441, train_acc: 1.00, valid_loss: 0.7206, valid_acc: 0.67, lr: 9.6720e-04, et: 0.0724
    epoch 058, train_loss: 0.0418, train_acc: 1.00, valid_loss: 0.7200, valid_acc: 0.67, lr: 9.6607e-04, et: 0.0716
    epoch 059, train_loss: 0.0350, train_acc: 1.00, valid_loss: 0.6783, valid_acc: 0.67, lr: 9.6492e-04, et: 0.0709
    epoch 060, train_loss: 0.0335, train_acc: 1.00, valid_loss: 0.6559, valid_acc: 0.67, lr: 9.6376e-04, et: 0.0706
    epoch 061, train_loss: 0.0260, train_acc: 1.00, valid_loss: 0.6665, valid_acc: 0.67, lr: 9.6258e-04, et: 0.0706
    epoch 062, train_loss: 0.0212, train_acc: 1.00, valid_loss: 0.6870, valid_acc: 0.73, lr: 9.6138e-04, et: 0.0706
    epoch 063, train_loss: 0.0183, train_acc: 1.00, valid_loss: 0.7055, valid_acc: 0.73, lr: 9.6016e-04, et: 0.0707
    epoch 064, train_loss: 0.0170, train_acc: 1.00, valid_loss: 0.6916, valid_acc: 0.73, lr: 9.5892e-04, et: 0.0707
    epoch 065, train_loss: 0.0168, train_acc: 1.00, valid_loss: 0.6861, valid_acc: 0.73, lr: 9.5766e-04, et: 0.0703
    epoch 066, train_loss: 0.0161, train_acc: 1.00, valid_loss: 0.6411, valid_acc: 0.73, lr: 9.5639e-04, et: 0.0890
    epoch 067, train_loss: 0.0151, train_acc: 1.00, valid_loss: 0.6392, valid_acc: 0.73, lr: 9.5510e-04, et: 0.0885
    epoch 068, train_loss: 0.0142, train_acc: 1.00, valid_loss: 0.6853, valid_acc: 0.67, lr: 9.5379e-04, et: 0.0702
    epoch 069, train_loss: 0.0128, train_acc: 1.00, valid_loss: 0.6783, valid_acc: 0.73, lr: 9.5246e-04, et: 0.0710
    epoch 070, train_loss: 0.0116, train_acc: 1.00, valid_loss: 0.6857, valid_acc: 0.73, lr: 9.5112e-04, et: 0.0717
    epoch 071, train_loss: 0.0107, train_acc: 1.00, valid_loss: 0.7017, valid_acc: 0.73, lr: 9.4975e-04, et: 0.0731
    epoch 072, train_loss: 0.0100, train_acc: 1.00, valid_loss: 0.6625, valid_acc: 0.73, lr: 9.4837e-04, et: 0.0709
    epoch 073, train_loss: 0.0108, train_acc: 1.00, valid_loss: 0.7138, valid_acc: 0.73, lr: 9.4697e-04, et: 0.0718
    epoch 074, train_loss: 0.0120, train_acc: 1.00, valid_loss: 0.8251, valid_acc: 0.67, lr: 9.4556e-04, et: 0.0697
    epoch 075, train_loss: 0.0132, train_acc: 1.00, valid_loss: 0.7651, valid_acc: 0.67, lr: 9.4412e-04, et: 0.0699
    epoch 076, train_loss: 0.0123, train_acc: 1.00, valid_loss: 0.7306, valid_acc: 0.67, lr: 9.4267e-04, et: 0.0701
    epoch 077, train_loss: 0.0095, train_acc: 1.00, valid_loss: 0.7432, valid_acc: 0.73, lr: 9.4120e-04, et: 0.0719
    epoch 078, train_loss: 0.0113, train_acc: 1.00, valid_loss: 1.0942, valid_acc: 0.60, lr: 9.3972e-04, et: 0.0699
    epoch 079, train_loss: 0.0095, train_acc: 1.00, valid_loss: 1.3673, valid_acc: 0.60, lr: 9.3822e-04, et: 0.0698
    epoch 080, train_loss: 0.0097, train_acc: 1.00, valid_loss: 1.4391, valid_acc: 0.67, lr: 9.3669e-04, et: 0.0698
    epoch 081, train_loss: 0.0045, train_acc: 1.00, valid_loss: 1.1827, valid_acc: 0.60, lr: 9.3516e-04, et: 0.0696
    epoch 082, train_loss: 0.0047, train_acc: 1.00, valid_loss: 0.8522, valid_acc: 0.60, lr: 9.3360e-04, et: 0.0694
    epoch 083, train_loss: 0.0054, train_acc: 1.00, valid_loss: 0.8625, valid_acc: 0.80, lr: 9.3203e-04, et: 0.0697
    epoch 084, train_loss: 0.0051, train_acc: 1.00, valid_loss: 0.7447, valid_acc: 0.73, lr: 9.3044e-04, et: 0.0706
    epoch 085, train_loss: 0.0057, train_acc: 1.00, valid_loss: 0.7076, valid_acc: 0.80, lr: 9.2883e-04, et: 0.0705
    epoch 086, train_loss: 0.0069, train_acc: 1.00, valid_loss: 0.6453, valid_acc: 0.80, lr: 9.2721e-04, et: 0.0701
    epoch 087, train_loss: 0.0085, train_acc: 1.00, valid_loss: 0.6115, valid_acc: 0.80, lr: 9.2557e-04, et: 0.0703
    epoch 088, train_loss: 0.0066, train_acc: 1.00, valid_loss: 0.7158, valid_acc: 0.73, lr: 9.2392e-04, et: 0.0700
    epoch 089, train_loss: 0.0071, train_acc: 1.00, valid_loss: 0.8055, valid_acc: 0.80, lr: 9.2224e-04, et: 0.0699
    epoch 090, train_loss: 0.0080, train_acc: 1.00, valid_loss: 0.8576, valid_acc: 0.73, lr: 9.2055e-04, et: 0.0698
    epoch 091, train_loss: 0.0083, train_acc: 1.00, valid_loss: 0.8679, valid_acc: 0.80, lr: 9.1885e-04, et: 0.0701
    epoch 092, train_loss: 0.0073, train_acc: 1.00, valid_loss: 0.8420, valid_acc: 0.80, lr: 9.1712e-04, et: 0.0710
    epoch 093, train_loss: 0.0060, train_acc: 1.00, valid_loss: 0.8550, valid_acc: 0.73, lr: 9.1538e-04, et: 0.0710
    epoch 094, train_loss: 0.0051, train_acc: 1.00, valid_loss: 0.9087, valid_acc: 0.67, lr: 9.1363e-04, et: 0.0708
    epoch 095, train_loss: 0.0045, train_acc: 1.00, valid_loss: 0.8944, valid_acc: 0.67, lr: 9.1185e-04, et: 0.0699
    epoch 096, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.8270, valid_acc: 0.60, lr: 9.1007e-04, et: 0.0699
    epoch 097, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.7914, valid_acc: 0.60, lr: 9.0826e-04, et: 0.0698
    epoch 098, train_loss: 0.0044, train_acc: 1.00, valid_loss: 0.7827, valid_acc: 0.60, lr: 9.0644e-04, et: 0.0703
    epoch 099, train_loss: 0.0040, train_acc: 1.00, valid_loss: 0.8140, valid_acc: 0.60, lr: 9.0460e-04, et: 0.0713
    epoch 100, train_loss: 0.0037, train_acc: 1.00, valid_loss: 0.8454, valid_acc: 0.60, lr: 9.0275e-04, et: 0.0697
    epoch 101, train_loss: 0.0036, train_acc: 1.00, valid_loss: 0.8484, valid_acc: 0.60, lr: 9.0088e-04, et: 0.0705
    epoch 102, train_loss: 0.0039, train_acc: 1.00, valid_loss: 0.8544, valid_acc: 0.60, lr: 8.9900e-04, et: 0.0722
    epoch 103, train_loss: 0.0045, train_acc: 1.00, valid_loss: 0.8934, valid_acc: 0.60, lr: 8.9710e-04, et: 0.0701
    epoch 104, train_loss: 0.0041, train_acc: 1.00, valid_loss: 0.9077, valid_acc: 0.60, lr: 8.9518e-04, et: 0.0696
    epoch 105, train_loss: 0.0040, train_acc: 1.00, valid_loss: 0.9105, valid_acc: 0.60, lr: 8.9325e-04, et: 0.0712
    epoch 106, train_loss: 0.0042, train_acc: 1.00, valid_loss: 0.8756, valid_acc: 0.60, lr: 8.9130e-04, et: 0.0703
    epoch 107, train_loss: 0.0040, train_acc: 1.00, valid_loss: 0.8439, valid_acc: 0.60, lr: 8.8934e-04, et: 0.0699
    epoch 108, train_loss: 0.0038, train_acc: 1.00, valid_loss: 0.8646, valid_acc: 0.60, lr: 8.8736e-04, et: 0.0718
    epoch 109, train_loss: 0.0034, train_acc: 1.00, valid_loss: 0.8887, valid_acc: 0.60, lr: 8.8537e-04, et: 0.0714
    epoch 110, train_loss: 0.0035, train_acc: 1.00, valid_loss: 0.8963, valid_acc: 0.60, lr: 8.8336e-04, et: 0.0714
    epoch 111, train_loss: 0.0036, train_acc: 1.00, valid_loss: 0.8084, valid_acc: 0.60, lr: 8.8134e-04, et: 0.0724
    epoch 112, train_loss: 0.0037, train_acc: 1.00, valid_loss: 0.7398, valid_acc: 0.67, lr: 8.7930e-04, et: 0.0702
    epoch 113, train_loss: 0.0038, train_acc: 1.00, valid_loss: 0.7146, valid_acc: 0.73, lr: 8.7725e-04, et: 0.0704
    epoch 114, train_loss: 0.0036, train_acc: 1.00, valid_loss: 0.7060, valid_acc: 0.73, lr: 8.7518e-04, et: 0.0700
    epoch 115, train_loss: 0.0038, train_acc: 1.00, valid_loss: 1.1091, valid_acc: 0.60, lr: 8.7310e-04, et: 0.0703
    epoch 116, train_loss: 0.0076, train_acc: 1.00, valid_loss: 1.3411, valid_acc: 0.53, lr: 8.7100e-04, et: 0.0705
    epoch 117, train_loss: 0.0130, train_acc: 1.00, valid_loss: 1.4149, valid_acc: 0.47, lr: 8.6889e-04, et: 0.0705
    epoch 118, train_loss: 0.0212, train_acc: 1.00, valid_loss: 1.4666, valid_acc: 0.47, lr: 8.6676e-04, et: 0.0704
    epoch 119, train_loss: 0.0136, train_acc: 1.00, valid_loss: 1.4336, valid_acc: 0.53, lr: 8.6462e-04, et: 0.0711
    epoch 120, train_loss: 0.0091, train_acc: 1.00, valid_loss: 1.3810, valid_acc: 0.60, lr: 8.6246e-04, et: 0.0711
    epoch 121, train_loss: 0.0071, train_acc: 1.00, valid_loss: 1.2678, valid_acc: 0.60, lr: 8.6029e-04, et: 0.0704
    Early stopping was triggered: epoch #122
    Elapsed Time: 8.80s
    keywords_train                                                      [7]
    keywords_valid                                                      [7]
    keywords_test                                                         7
    classifier                                                    eegnet4.2
    accuracy                                                       0.666667
    labels                    [0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1]
    preds                     [0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0]
    probas                [[0.7581711, 0.24182892], [0.41009733, 0.58990...
    logits                [[0.55972236, -0.5829562], [0.09446951, 0.4580...
    desc                                           eegnet4.2/drop_prob=0.25
    normalization_mean    [-7.833245201352182e-08, -7.58465477061568e-08...
    normalization_std     [5.433117158191253e-06, 5.877842086826285e-06,...
    Name: 0, dtype: object





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 28.814 seconds)


.. _sphx_glr_download_auto_examples_example_within-subject-classification-deeplearning.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_within-subject-classification-deeplearning.ipynb <example_within-subject-classification-deeplearning.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_within-subject-classification-deeplearning.py <example_within-subject-classification-deeplearning.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: example_within-subject-classification-deeplearning.zip <example_within-subject-classification-deeplearning.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
